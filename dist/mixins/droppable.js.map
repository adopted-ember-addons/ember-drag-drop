{"version":3,"file":"droppable.js","sources":["../../src/mixins/droppable.js"],"sourcesContent":["/* eslint-disable ember/no-get, ember/no-new-mixins, prettier/prettier */\nimport Mixin from '@ember/object/mixin';\n\n/**\n * Wraps the native drop events to make your components droppable.\n *\n * @mixin Droppable\n */\n\nvar Droppable = Mixin.create({\n  _currentDrag: null,\n  classNameBindings: [\n    'accepts-drag',\n    'self-drop'\n  ],\n\n  /**\n   * Read-only className property that is set to true when the component is\n   * receiving a valid drag event. You can style your element with\n   * `.accepts-drag`.\n   *\n   * @property accepts-drag\n   * @private\n   */\n\n  'accepts-drag': false,\n\n  /**\n   * Will be true when the component is dragged over itself. Can use\n   * `.self-drop` in your css to style (or more common, unstyle) the component.\n   *\n   * @property self-drop\n   * @private\n   */\n\n  'self-drop': false,\n\n /**\n   * Validates drag events. Override this to restrict which data types your\n   * component accepts.\n   *\n   * Example:\n   *\n   * ```js\n   * validateDragEvent(event) {\n   *   return event.dataTransfer.types.contains('text/x-foo');\n   * }\n   * ```\n   *\n   * @method validateDragEvent\n   * @public\n   */\n\n  validateDragEvent() {\n    return true;\n  },\n\n  /**\n   * Called when a valid drag event is dropped on the component. Override to\n   * actually make something happen.\n   *\n   * ```js\n   * acceptDrop: function(event) {\n   *   var data = event.dataTransfer.getData('text/plain');\n   *   doSomethingWith(data);\n   * }\n   * ```\n   *\n   * @method acceptDrop\n   * @public\n   */\n\n  acceptDrop() {},\n\n  handleDragOver() {},\n  handleDragOut() {},\n\n  /**\n   * @method dragOver\n   * @private\n   */\n\n  dragOver(event) {\n    if (this._droppableIsDraggable(event)) {\n      this.set('self-drop', true);\n    }\n    if (this.get('accepts-drag')) {\n      return this._allowDrop(event);\n    }\n    if (this.validateDragEvent(event)) {\n      this.set('accepts-drag', true);\n      this._allowDrop(event);\n    } else {\n      this._resetDroppability();\n    }\n  },\n\n  /**\n   * @method dragEnter\n   * @private\n   */\n\n  dragEnter() {\n    return false;\n  },\n\n  /**\n   * @method drop\n   * @private\n   */\n\n  drop(event) {\n    // have to validate on drop because you may have nested sortables the\n    // parent allows the drop but the child receives it, revalidating allows\n    // the event to bubble up to the parent to handle it\n    if (!this.validateDragEvent(event)) {\n      return;\n    }\n    this.acceptDrop(event);\n    this._resetDroppability();\n    // TODO: might not need this? I can't remember why its here\n    event.stopPropagation();\n    return false;\n  },\n\n  /**\n   * Tells the browser we have an acceptable drag event.\n   *\n   * @method _allowDrop\n   * @private\n   */\n\n  _allowDrop(event) {\n    this.handleDragOver(event);\n    event.stopPropagation();\n    event.preventDefault();\n    return false;\n  },\n\n  /**\n   * We want to be able to know if the current drop target is the original\n   * element being dragged or a child of it.\n   *\n   * @method _droppableIsDraggable\n   * @private\n   */\n\n  _droppableIsDraggable(event) {\n    return Droppable._currentDrag && (\n      Droppable._currentDrag === event.target ||\n      Droppable._currentDrag.contains(event.target)\n    );\n  },\n\n  /**\n   * @method _resetDroppability\n   * @private\n   */\n\n  _resetDroppability(event) {\n    this.handleDragOut(event);\n    this.set('accepts-drag', false);\n    this.set('self-drop', false);\n  },\n\n  dragLeave() {\n   this._resetDroppability();\n  },\n\n  // Need to track this so we can determine `self-drop`.\n  // It's on `Droppable` so we can test :\\\n  dragStart(event) {\n    this.set('_currentDrag', event.target);\n  }\n\n});\n\nexport default Droppable;\n"],"names":["Droppable","Mixin","create","_currentDrag","classNameBindings","validateDragEvent","acceptDrop","handleDragOver","handleDragOut","dragOver","event","_droppableIsDraggable","set","get","_allowDrop","_resetDroppability","dragEnter","drop","stopPropagation","preventDefault","target","contains","dragLeave","dragStart"],"mappings":"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"}